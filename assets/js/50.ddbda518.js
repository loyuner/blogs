(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{506:function(s,n,e){"use strict";e.r(n);var a=e(2),t=Object(a.a)({},(function(){var s=this,n=s._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h2",{attrs:{id:"校内赛"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#校内赛"}},[s._v("#")]),s._v(" 校内赛")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("安杯2019--easyweb")]),s._v(" "),n("p",[s._v("看到这个链接我就觉得有猫病，url后面跟着这么奇怪的数据")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("pVek5yTENbVUzTVRabE5gVz\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("起手就是一个base64解码：MzUzNTM1MmU3MDZlNjc=，还得二次64解码得到3535352e706e67，看起来是16进制555.png")]),s._v(" "),n("p",[s._v("我是觉得作用就是将对象包含并进行转16进制再base64编码后输出，那我想要源码了，咋办？？？\n包index.php")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("index.php\n696e6465782e706870\nNjk2ZTY0NjU3ODJlNzA2ODcwCg==\nTmprMlpUWTBOalUzT0RKbE56QTJPRGN3\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[s._v("放入img参数进行上传得到base64，直接解码得到")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('<?php\nerror_reporting(E_ALL || ~ E_NOTICE);\nheader(\'content-type:text/html;charset=utf-8\');\n$cmd = $_GET[\'cmd\'];\nif (!isset($_GET[\'img\']) || !isset($_GET[\'cmd\'])) \n    header(\'Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&cmd=\');\n$file = hex2bin(base64_decode(base64_decode($_GET[\'img\'])));\n\n$file = preg_replace("/[^a-zA-Z0-9.]+/", "", $file);\nif (preg_match("/flag/i", $file)) {\n    echo \'<img src ="./ctf3.jpeg">\';\n    die("xixi～ no flag");\n} else {\n    $txt = base64_encode(file_get_contents($file));\n    echo "<img src=\'data:image/gif;base64," . $txt . "\'></img>";\n    echo "<br>";\n}\necho $cmd;\necho "<br>";\nif (preg_match("/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\'|"|`|;|,|*|?|\\|\\\\|n|t|r|xA0|{|}|(|)|&[^d]|@|||\\$|[|]|{|}|(|)|-|<|>/i", $cmd)) {\n    echo("forbid ~");\n    echo "<br>";\n} else {\n    if ((string)$_POST[\'a\'] !== (string)$_POST[\'b\'] && md5($_POST[\'a\']) === md5($_POST[\'b\'])) {\n        echo `$cmd`;\n    } else {\n        echo ("md5 is funny ~");\n    }\n}\n\n?>\n<html>\n<style>\n  body{\n   background:url(./bj.png)  no-repeat center center;\n   background-size:cover;\n   background-attachment:fixed;\n   background-color:#CCCCCC;\n}\n</style>\n<body>\n</body>\n</html>\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br")])]),n("p",[s._v("我是菜鸡，到这里看不太懂，但是觉得这重要")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("if (preg_match(\"/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|'|\"|`|;|,|*|?|\\|\\\\|n|t|r|xA0|{|}|(|)|&[^d]|@|||\\$|[|]|{|}|(|)|-|<|>/i\", $cmd)) {     //跟这里匹配到了就会结束代码，所以需要绕过\n    echo(\"forbid ~\");\n    echo \"<br>\";\n} else {\n    if ((string)$_POST['a'] !== (string)$_POST['b'] && md5($_POST['a']) === md5($_POST['b'])) {    //a和b的内容不一样但是需要md5值一样\n        echo `$cmd`;          //将cmd当成系统命令执行并输出\n    } else {\n        echo (\"md5 is funny ~\");\n    }\n}\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("p",[s._v("还得绕或preg_match，使用"),n("code",[s._v("\\")]),s._v("绕过，因为在liunx下，l\\s等于ls\n然后md5的话我实验数组绕过，这个csdn一堆\n接下来就是ls和cat了，相信大佬都会了")])])])])}),[],!1,null,null,null);n.default=t.exports}}]);